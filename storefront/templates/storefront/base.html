{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>{% block title %}{{ business.business_name|default:"Nexus Shop" }}{% endblock %}</title>
    
    <!-- Basic SEO Meta Tags -->
    <meta name="description" content="{% block meta_description %}{{ business.business_description|default:"Shop premium products online" }}{% endblock %}" />
    <meta name="keywords" content="{% block meta_keywords %}online shopping, products, {{ business.business_name|default:'shop' }}{% endblock %}" />
    <meta name="author" content="{{ business.business_name|default:'Nexus' }}" />
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <link rel="canonical" href="{{ request.build_absolute_uri }}" />
    
    <!-- Open Graph Tags for Social Media -->
    <meta property="og:type" content="{% block og_type %}website{% endblock %}" />
    <meta property="og:title" content="{% block og_title %}{{ business.business_name|default:'Nexus Shop' }}{% endblock %}" />
    <meta property="og:description" content="{% block og_description %}{{ business.business_description|default:'Shop online' }}{% endblock %}" />
    <meta property="og:image" content="{% block og_image %}{{ business.logo_url|default:'' }}{% endblock %}" />
    <meta property="og:url" content="{{ request.build_absolute_uri }}" />
    <meta property="og:site_name" content="{{ business.business_name|default:'Nexus' }}" />
    
    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="{% block twitter_card %}summary_large_image{% endblock %}" />
    <meta name="twitter:title" content="{% block twitter_title %}{{ business.business_name|default:'Nexus Shop' }}{% endblock %}" />
    <meta name="twitter:description" content="{% block twitter_description %}{{ business.business_description|default:'Shop online' }}{% endblock %}" />
    <meta name="twitter:image" content="{% block twitter_image %}{{ business.logo_url|default:'' }}{% endblock %}" />
    
    <!-- Mobile App Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="{{ business.business_name|default:'Nexus' }}" />
    
    <!-- Structured Data (JSON-LD) -->
        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "LocalBusiness",
            "name": "{{ business.business_name|default:'Nexus' }}",
            "description": "{{ business.business_description|default:'Online store' }}",
            "url": "{{ business.website_url|default:request.build_absolute_uri }}",
            "logo": "{{ business.logo_url|default:'' }}",
            {% if business.business_address or business.business_phone_number or business.latitude or business.longitude or business.opening_hours %}
            "address": {
                "@type": "PostalAddress",
                "streetAddress": "{{ business.business_address|default:'' }}"
            },
            "telephone": "{{ business.business_phone_number|default:'' }}",
            {% if business.latitude and business.longitude %}
            "geo": {
                "@type": "GeoCoordinates",
                "latitude": "{{ business.latitude }}",
                "longitude": "{{ business.longitude }}"
            },
            {% endif %}
            {% if business.opening_hours %}
            "openingHoursSpecification": {{ business.opening_hours|default:'[]' }},
            {% endif %}
            {% if business.average_rating and business.total_reviews %}
            "aggregateRating": {
                "@type": "AggregateRating",
                "ratingValue": "{{ business.average_rating }}",
                "reviewCount": "{{ business.total_reviews }}"
            },
            {% endif %}
            "priceRange": "{{ business.price_range|default:'' }}"
            {% else %}
            "priceRange": "{{ business.price_range|default:'' }}"
            {% endif %}
        }
        </script>
        <!-- Sitelinks SearchBox -->
        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "{{ business.website_url|default:request.build_absolute_uri }}",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "{{ request.scheme }}://{{ request.get_host }}{% url 'shop_home' %}?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <!-- Breadcrumbs (BreadcrumbList) - will use `breadcrumbs` context var when provided -->
        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [
                {% if breadcrumbs %}
                    {% for crumb in breadcrumbs %}
                        {
                            "@type": "ListItem",
                            "position": {{ forloop.counter }},
                            "name": "{{ crumb.name|escapejs }}",
                            "item": "{{ crumb.url|default:request.build_absolute_uri }}"
                        }{% if not forloop.last %},{% endif %}
                    {% endfor %}
                {% else %}
                    {
                        "@type": "ListItem",
                        "position": 1,
                        "name": "Home",
                        "item": "{{ request.scheme }}://{{ request.get_host }}"
                    },
                    {
                        "@type": "ListItem",
                        "position": 2,
                        "name": "{{ request.path|slice:'1:'|replace:'/',' > '|default:request.path }}",
                        "item": "{{ request.build_absolute_uri }}"
                    }
                {% endif %}
            ]
        }
        </script>
    
    <link rel="icon" type="image/png" href="{% static 'icon.png' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Global Theme & Fonts -->
    {% include "storefront/theme_css.html" %}
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    {% block extra_head %}{% endblock %}
</head>

<body>
    {% include "storefront/partials/navbar.html" %}

    <div class="main-wrapper">
        {% block content %}{% endblock %}
    </div>

    {% include "storefront/partials/nexus_footer.html" %}
</body>

</html>