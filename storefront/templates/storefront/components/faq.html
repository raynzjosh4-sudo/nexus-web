<style>
    :root {
        --faq-bg: var(--nexus-card-bg, #181b21);
        --faq-border: var(--nexus-border, rgba(255,255,255,0.08));
        --nexus-accent: var(--nexus-accent, #f97316);
        --text-main: var(--nexus-text, #ffffff);
        --text-muted: var(--nexus-muted, #9ca3af);
    }

    .nexus-faq-section { padding: 40px 16px; width:100%; max-width:900px; margin:0 auto; }

    .nexus-section-title { font-size:1.5rem; color:var(--text-main); margin-bottom:18px; text-align:center; font-weight:700; }

    .faq-item { background: var(--faq-bg); border-radius:12px; margin-bottom:12px; overflow:hidden; border:1px solid var(--faq-border); box-shadow:0 2px 6px rgba(16,24,40,0.04); }
    .faq-item:hover { box-shadow:0 8px 24px rgba(16,24,40,0.08); }

    .faq-header { padding:16px 18px; display:flex; align-items:center; justify-content:space-between; gap:12px; cursor:pointer; }
    .faq-question { margin:0; font-size:1rem; font-weight:700; color:var(--text-main); }

    .faq-icon { width:28px; height:28px; display:inline-grid; place-items:center; border-radius:8px; background:transparent; color:var(--nexus-accent); transition:transform 0.18s ease, background 0.18s ease; }
    .faq-item[aria-expanded='true'] .faq-icon { transform: rotate(45deg); background: rgba(26,115,232,0.08); }

    .faq-body { padding: 0 18px; }
    .faq-content-inner { max-height:0; overflow:hidden; transition:max-height 0.28s ease, padding 0.28s ease; color:var(--text-muted); line-height:1.6; }
    .faq-item[aria-expanded='true'] .faq-content-inner { padding:12px 0 18px 0; max-height:400px; }

    /* accessibility focus */
    .faq-header:focus { outline: 2px solid rgba(26,115,232,0.12); outline-offset: 4px; }
</style>

<div class="nexus-faq-section">
    {% if component.title %}
        <div class="nexus-section-header">
            <h3 class="nexus-section-title">{{ component.title }}</h3>
        </div>
    {% endif %}

    <div class="nexus-accordion">
        {% for item in component.items %}
            <div class="faq-item" role="region" aria-expanded="false">
                <div class="faq-header" tabindex="0" role="button" aria-controls="faq-{{ forloop.counter }}" onclick="toggleFaq(this.parentElement)" onkeydown="if(event.key==='Enter'||event.key===' ')toggleFaq(this.parentElement)">
                    <h4 class="faq-question">{{ item.question }}</h4>
                    <div class="faq-icon">+</div>
                </div>
                <div class="faq-body" id="faq-{{ forloop.counter }}">
                    <div class="faq-content-inner">
                        {{ item.answer|linebreaks }}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<script>
    function toggleFaq(element) {
        const expanded = element.getAttribute('aria-expanded') === 'true';
        element.setAttribute('aria-expanded', expanded ? 'false' : 'true');
    }
</script>

{# Structured data for FAQPage so Google can show FAQ rich results. Uses component.items when present. #}
{% if component.items %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
        {% for item in component.items %}
        {
            "@type": "Question",
            "name": "{{ item.question|escapejs }}",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "{{ item.answer|striptags|truncatechars:1000|escapejs }}"
            }{% if item.url %},
            "@id": "{{ request.scheme }}://{{ request.get_host }}{{ item.url }}"
            {% endif %}
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
    ]
}
</script>
{% endif %}