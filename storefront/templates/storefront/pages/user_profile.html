{% extends "storefront/pages/base_seo.html" %}

{% block header_meta %}
<div class="meta">
    <span>ðŸ‘¤ User Profile</span>
    <span>ðŸ“Š {{ listings|length }} Listings</span>
</div>
{% endblock %}

{% block main_content %}
<!-- User Profile -->
<article>
    <!-- Profile Header -->
    <div style="text-align: center; margin-bottom: 40px;">
        {% if user.avatar_url %}
        <img src="{{ user.avatar_url }}" alt="{{ user.full_name }}"
            style="width: 120px; height: 120px; border-radius: 50%; background: var(--theme-border); margin-bottom: 20px;">
        {% else %}
        <div
            style="width: 120px; height: 120px; margin: 0 auto; border-radius: 50%; background: var(--theme-border); display: flex; align-items: center; justify-content: center; font-size: 3rem; margin-bottom: 20px;">
            ðŸ‘¤
        </div>
        {% endif %}
        <h1 style="color: var(--theme-accent); margin-bottom: 10px;">{{ user.full_name }}</h1>
        <p style="color: var(--theme-accent-soft); font-size: 1.1rem; margin-bottom: 10px;">@{{ user.username }}</p>
    </div>

    <!-- Profile Bio -->
    {% if user.bio %}
    <div class="description">
        {{ user.bio }}
    </div>
    {% endif %}

    <!-- Profile Stats -->
    <div style="background: var(--theme-surface-alt); padding: 30px; border-radius: 8px; margin: 30px 0;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px;">
            <div style="text-align: center;">
                <div style="font-size: 2rem; color: var(--theme-accent); font-weight: 600; margin-bottom: 5px;">
                    {{ listings|length }}
                </div>
                <div style="color: var(--theme-accent-soft);">Active Listings</div>
            </div>
            {% if user.member_since %}
            <div style="text-align: center;">
                <div style="font-size: 2rem; color: var(--theme-accent); font-weight: 600; margin-bottom: 5px;">
                    âœ“
                </div>
                <div style="color: var(--theme-accent-soft);">Member Since {{ user.member_since|date:"Y" }}</div>
            </div>
            {% endif %}
            {% if user.reputation_score %}
            <div style="text-align: center;">
                <div style="font-size: 2rem; color: var(--theme-accent); font-weight: 600; margin-bottom: 5px;">
                    {{ user.reputation_score }}
                </div>
                <div style="color: var(--theme-accent-soft);">Reputation</div>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Contact Information -->
    <div
        style="background: var(--theme-surface-alt); padding: 20px; border-radius: 8px; margin: 30px 0; border-left: 4px solid var(--theme-accent);">
        <h3 style="color: var(--theme-accent); margin-bottom: 15px;">ðŸ“ž Contact</h3>
        <p style="color: var(--theme-text);">Contact this user on the Nexus app for trades, questions, or inquiries
            about their listings.</p>
    </div>

    <!-- Recent Listings -->
    {% if listings %}
    <div style="margin-top: 40px;">
        <h2 style="color: var(--theme-accent); margin-bottom: 20px;">ðŸ“¦ Active Listings</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">
            {% for listing in listings|slice:":8" %}
            <div
                style="background: var(--theme-surface-alt); border: 1px solid var(--theme-border); border-radius: 8px; overflow: hidden; transition: all 0.3s;">
                {% if listing.image %}
                <img src="{{ listing.image }}" alt="{{ listing.title }}"
                    style="width: 100%; height: 150px; object-fit: cover; background: var(--theme-border);">
                {% else %}
                <div
                    style="width: 100%; height: 150px; background: var(--theme-border); display: flex; align-items: center; justify-content: center; color: var(--theme-accent-soft);">
                    ðŸ“·
                </div>
                {% endif %}
                <div style="padding: 15px;">
                    <h3 style="color: var(--theme-accent); margin-bottom: 5px; font-size: 0.95rem;">
                        {{ listing.title|truncatewords:5 }}
                    </h3>
                    <p style="color: var(--theme-accent-soft); font-size: 0.9rem;">{{ listing.category }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Action Buttons -->
    <div class="action-buttons" style="margin-top: 40px;">
        <a href="https://play.google.com/store/apps/details?id=com.nexus.marketplace" class="btn btn-primary">
            ðŸ”— Contact on Nexus App
        </a>
        <a href="/" class="btn btn-secondary">
            Back to Marketplace
        </a>
    </div>
</article>
{% endblock %}